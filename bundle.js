!function(e){function t(t){for(var s,r,l=t[0],a=t[1],h=t[2],d=0,u=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&u.push(n[r][0]),n[r]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);for(c&&c(t);u.length;)u.shift()();return o.push.apply(o,h||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],s=!0,l=1;l<i.length;l++){var a=i[l];0!==n[a]&&(s=!1)}s&&(o.splice(t--,1),e=r(r.s=i[0]))}return e}var s={},n={0:0},o=[];function r(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=s,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var h=0;h<l.length;h++)t(l[h]);var c=a;o.push([6,1]),i()}([,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextOverlay=void 0;class s{static console(e){console.log(e)}static points(e){document.getElementById("points").innerText=String(e)}static multiplier(e){document.getElementById("multiplier").innerText=String(e)}static lives(e){document.getElementById("lives").innerText=String(e)}static info(e){clearTimeout(this.handler),document.getElementById("info").innerHTML=e}static message(e){clearTimeout(s.handler),document.getElementById("info").innerHTML=e,s.handler=setTimeout((function(){document.getElementById("info").innerHTML=""}),5e3)}static clear(){document.getElementById("points").innerText="",document.getElementById("lives").innerText="",document.getElementById("info").innerHTML=""}}t.TextOverlay=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StageManager=void 0;t.StageManager=class{static request(e){let t=new CustomEvent("stage",{detail:e});document.dispatchEvent(t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const s=i(0),n=i(8),o=i(9),r=i(10),l=i(2),a=i(1),h=i(11),c=i(4),d=i(12),u=i(13);class p extends s.Scene{constructor(){super(),this.fog=new s.FogExp2(15794160,.14),this.background=new s.Color(15794160);let e=new s.HemisphereLight(16775930,0,.9);this.add(e);let t=new s.DirectionalLight(13484485,.9);t.position.set(12,6,-7),this.add(t),this.world=new n.World(26),this.add(this.world),this.hero=new o.Hero(.2),this.hero.position.y=this.world.radius+.1,this.add(this.hero),this.coll=new r.Collision,this.boom=new u.ExplosionManager(this.world),this.multiplier=1,this.points=0,this.lives=3,a.TextOverlay.points(this.points),a.TextOverlay.lives(this.lives),a.TextOverlay.message("Quick! Get ready!")}initialize(e){e.lookAt(this.hero.position),this.audio=new h.AudioFx(e)}update(e){let t=this.world.sf.up().obstacle;if(null!=t&&t.visible){let e=this.coll.check(this.hero,t);null!=e&&this.handleCollision(e)}this.world.update()&&(this.audio.section(),this.multiplier>1&&this.multiplier--,a.TextOverlay.multiplier(this.multiplier)),this.world.animate(e),this.hero.animate(e),this.boom.animate(e)}handleKeyEvent(e){let t="keydown"===e.type;switch(e.key){case"ArrowLeft":t&&this.hero.move(-1);break;case"ArrowRight":t&&this.hero.move(1)}}handleClickEvent(e){let t=document.body.clientWidth/2;e.clientX>t?this.hero.move(1):this.hero.move(-1)}handleCollision(e){e.visible=!1;let t=e.kind;this.boom.explode(e.position,e.material.color),t===c.ObstacleKind.GOOD?(this.points+=this.multiplier,this.multiplier+=2,a.TextOverlay.points(this.points),a.TextOverlay.multiplier(this.multiplier),this.audio.green()):(this.lives--,this.multiplier=1,a.TextOverlay.lives(this.lives),a.TextOverlay.multiplier(this.multiplier),this.audio.red(),a.TextOverlay.message("Be careful!"),0==this.lives&&(this.hero.die(),a.TextOverlay.message("You lost!"),setTimeout((function(){l.StageManager.request(new d.Over)}),2e3)))}}t.Game=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Obstacle=t.ObstacleFactory=t.ObstacleKind=void 0;const s=i(0);var n;!function(e){e[e.GOOD=0]="GOOD",e[e.BAD=1]="BAD",e[e.BORDER=2]="BORDER"}(n=t.ObstacleKind||(t.ObstacleKind={}));t.ObstacleFactory=class{static good(){return new o(.5,65280,n.GOOD)}static bad(){return new o(.75,16711680,n.BAD)}static border(e){return new o(.5,e?0:16776960,n.BORDER)}};class o extends s.Mesh{constructor(e,t,i){super(new s.BoxGeometry(e,e,2*e),new s.MeshStandardMaterial({color:t,flatShading:!0})),this.kind=i}}t.Obstacle=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LANES=t.Lane=void 0;class s{constructor(e){this.index=e;let t=Math.PI/96;this.angle=e*t}}t.Lane=s,t.LANES={LEFT_BORDER:new s(-2),LEFT:new s(-1),CENTER:new s(0),RIGHT:new s(1),RIGHT_BORDER:new s(2)},t.LANES.LEFT.left=t.LANES.LEFT,t.LANES.LEFT.right=t.LANES.CENTER,t.LANES.CENTER.left=t.LANES.LEFT,t.LANES.CENTER.right=t.LANES.RIGHT,t.LANES.RIGHT.left=t.LANES.CENTER,t.LANES.RIGHT.right=t.LANES.RIGHT},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const s=i(0),n=i(1),o=i(7);class r{constructor(){n.TextOverlay.console("GGRB Game v0.1.3"),n.TextOverlay.console("THREE r"+s.REVISION);let e=new s.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.1,1e3),t=new s.WebGLRenderer({antialias:!0});t.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(t.domElement),window.addEventListener("resize",(function(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight)}),!1);let i=new o.Intro,r=function(e){i.handleKeyEvent(e)};document.onkeydown=r,document.onkeyup=r,document.onmousedown=function(e){i.handleClickEvent(e)};let l=!0;document.addEventListener("visibilitychange",(function(e){a.getDelta(),l=!document.hidden})),document.addEventListener("stage",(function(t){i=t.detail,i.initialize(e)}),!1),e.position.z=4,e.position.y=30,e.position.x=0,i.initialize(e),this.camera=e,this.scene=i,this.renderer=t;let a=new s.Clock,h=function(){requestAnimationFrame(h);let s=a.getDelta();l&&(i.update(s),t.render(i,e))};h()}launch(){}}t.App=r,(new r).launch()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Intro=void 0;const s=i(0),n=i(1),o=i(2),r=i(3);class l extends s.Scene{constructor(){super(),this.background=new s.Color(12840887);let e=new s.HemisphereLight(16775930,0,.9);this.add(e);let t=new s.DirectionalLight(13484485,.9);t.position.set(12,6,-7),this.add(t)}initialize(e){n.TextOverlay.info("Use arrow keys to move <br/> Click to start")}update(e){}handleKeyEvent(e){this.startGame()}handleClickEvent(e){this.startGame()}startGame(){o.StageManager.request(new r.Game)}}t.Intro=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.World=void 0;const s=i(0),n=i(4),o=i(5),r=2*Math.PI/128;class l extends s.Group{constructor(e,t){super(),this.leftBorder=e,this.rightBorder=t,this.add(this.leftBorder),this.add(this.rightBorder)}update(e){this.remove(this.obstacle),this.obstacle=e,this.add(e),e.visible=!0}}class a{constructor(e,t){this.spherical=new s.Spherical,this.radius=e,this.center=t}reposition(e,t,i){this.spherical.set(this.radius,Math.PI/2-t.angle,e*r),i.position.setFromSpherical(this.spherical),i.lookAt(this.center)}}class h{constructor(e){this.sections=[],this.greens=[],this.reds=[],this.counter=0;for(let t=0;t<16;t++){let i=t%2==0,s=new l(n.ObstacleFactory.border(i),n.ObstacleFactory.border(i));this.sections.push(s),e.add(s),this.greens.push(n.ObstacleFactory.good()),this.reds.push(n.ObstacleFactory.bad())}this.helper=new a(e.radius,e.position),this.radius=e.radius,this.center=e.position.clone()}request(e){let t=this.sections.shift();return this.reposition(e,t),this.sections.push(t),t}reposition(e,t){this.sequential(e,t)}up(){return this.sections[4]}empty(e,t){this.helper.reposition(e+12,o.LANES.LEFT_BORDER,t.leftBorder),this.helper.reposition(e+12,o.LANES.RIGHT_BORDER,t.rightBorder)}test(e,t){this.empty(e,t);let i=this.greens.shift();this.greens.push(i),e%12==0?this.helper.reposition(e+12,o.LANES.LEFT,i):e%6==0?this.helper.reposition(e+12,o.LANES.RIGHT,i):this.helper.reposition(e+12,o.LANES.CENTER,i),t.update(i)}randomize(e,t){let i;switch(this.empty(e,t),Math.random()<.1?(i=this.reds.shift(),this.reds.push(i)):(i=this.greens.shift(),this.greens.push(i)),Math.floor(3*Math.random())){case 0:this.helper.reposition(e+12,o.LANES.LEFT,i);break;case 1:this.helper.reposition(e+12,o.LANES.CENTER,i);break;case 2:this.helper.reposition(e+12,o.LANES.RIGHT,i)}t.update(i)}sequential(e,t){this.counter++,this.counter<10?this.empty(e,t):this.counter<50?this.test(e,t):this.randomize(e,t)}}class c extends s.Mesh{constructor(e){super(new s.SphereGeometry(e,40,40),new s.MeshStandardMaterial({color:16775930,flatShading:!0})),this.rotation.z=Math.PI/2,this.radius=e,this.helper=new s.Spherical,this.sf=new h(this),this.lastSection=-1}upSection(){let e=(this.rotation.x%(2*Math.PI)+Math.PI/2)/r;return Math.floor(e)}update(){let e=this.upSection();if(this.lastSection===e)return!1;this.lastSection=e;this.sf.request(e);return!0}animate(e){this.rotation.x+=.3*e}}t.World=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hero=void 0;const s=i(0),n=i(5);class o extends s.Mesh{constructor(e){super(new s.DodecahedronGeometry(e,1),new s.MeshStandardMaterial({color:7317724,flatShading:!0})),this.lane=n.LANES.CENTER}move(e){this.lane=e>0?this.lane.right:this.lane.left}die(){this.position.y=0}animate(e){this.rotation.x+=-26*e;let t=s.MathUtils.lerp(this.position.x,this.lane.index,6*e);this.position.x=t}}t.Hero=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collision=void 0;const s=i(0);t.Collision=class{constructor(){this.raycaster=new s.Raycaster}check(e,t){let i=[];return null!=t&&i.push(t),this.checks(e,i)}checks(e,t){let i=e.geometry,n=this.toVertices(i),o=e.position.clone();for(let i=0;i<n.length;i++){let r=n[i].clone().applyMatrix4(e.matrix).sub(e.position),l=new s.Raycaster(o,r.clone().normalize()).intersectObjects(t);if(l.length>0&&l[0].distance<r.length())return l[0].object}return null}toVertices(e){let t=[];const i=e.attributes.position.array;for(let e=0;e<i.length;e+=3)t.push(new s.Vector3(i[e],i[e+1],i[e+2]));return t}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioFx=void 0;const s=i(0);t.AudioFx=class{constructor(e){const t=new s.AudioListener;e.add(t);const i=new s.AudioLoader;this.sectionFx=new s.PositionalAudio(t),i.load("res/section.mp3",e=>{this.sectionFx.setBuffer(e),this.sectionFx.setRefDistance(20)}),this.greenFx=new s.PositionalAudio(t),i.load("res/green.mp3",e=>{this.greenFx.setBuffer(e),this.greenFx.setRefDistance(20)}),this.redFx=new s.PositionalAudio(t),i.load("res/red.mp3",e=>{this.redFx.setBuffer(e),this.redFx.setRefDistance(20)})}red(){this.redFx.isPlaying&&this.redFx.stop(),this.redFx.play()}green(){this.greenFx.isPlaying&&this.greenFx.stop(),this.greenFx.play()}section(){this.sectionFx.isPlaying&&this.sectionFx.stop(),this.sectionFx.play()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Over=void 0;const s=i(0),n=i(1),o=i(3);class r extends s.Scene{constructor(){super(),this.background=new s.Color(15710135);let e=new s.HemisphereLight(16775930,0,.9);this.add(e);let t=new s.DirectionalLight(13484485,.9);t.position.set(12,6,-7),this.add(t)}initialize(e){n.TextOverlay.info("Game over <br/> Click to restart :)")}update(e){}handleKeyEvent(e){}handleClickEvent(e){this.startGame()}startGame(){let e=new CustomEvent("stage",{detail:new o.Game});document.dispatchEvent(e)}}t.Over=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Explosion=t.ExplosionManager=void 0;const s=i(0);t.ExplosionManager=class{constructor(e){this.explosions=[],this.world=e}explode(e,t){let i=new n(e,t);this.world.add(i.object),this.explosions.push(i),setTimeout((function(e,t){e.remove(i.object),t.length>3&&t.shift()}),1e3,this.world,this.explosions)}animate(e){for(let t of this.explosions)t.animate(e)}};class n{constructor(e,t){this.dirs=[];let i=new s.BufferGeometry,n=[];for(let t=0;t<100;t++)n.push(e.x),n.push(e.y),n.push(e.z),this.dirs.push(new s.Vector3(.25*Math.random()-.125,.25*Math.random()-.125,.25*Math.random()-.125));i.setAttribute("position",new s.Float32BufferAttribute(n,3));let o=new s.PointsMaterial({size:.25,color:t}),r=new s.Points(i,o);this.object=r}animate(e){let t=100,i=this.object.geometry.attributes.position;for(;t--;)i.setXYZ(t,i.getX(t)+this.dirs[t].x,i.getY(t)+this.dirs[t].y,i.getZ(t)+this.dirs[t].z);this.object.geometry.attributes.position.needsUpdate=!0}}t.Explosion=n}]);